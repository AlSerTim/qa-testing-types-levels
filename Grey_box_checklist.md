# Чек-лист Grey-box: приложение «Найди и иди"

> Тестировщик имеет доступ к базе данных магазинов и серверным логам.

| №  | ID требования | Шаг в UI                                                           | Что проверяем в БД или логах                                                           | Ожидаемый результат                                                                                                    |
|----|---------------|--------------------------------------------------------------------|----------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 1  | SC21-01       | Попытаться ввести более 50 символов в поле поиска и нажать «Поиск» | Проверить, что в `search_history` сохранены только первые 50 символов                  | Фронт обрывает ввод на 50 символах и показывает «Максимум 50 символов»; в БД сохраняется обрезка                       |
| 2  | SC21-02       | Выбрать «Продуктовые магазины» и нажать «Поиск»                    | SQL: `SELECT COUNT(*) FROM product_shops WHERE type='grocery';`                        | Маркеров на карте столько же, сколько записей в таблице `product_shops` с type='grocery'                               |
| 3  | SC21-02       | Сбросить выбор типа и нажать «Поиск»                               | Логи: фильтр сброшен                                                                   | Показаны все магазины без фильтра                                                                                      |
| 4  | SC21-02       | В БД добавить новый тип «Books» и обновить UI                      | SQL: `INSERT INTO shop_types(name) VALUES('Books');`                                   | В списке выбора появился пункт «Books» без изменений клиентского кода                                                  |
| 5  | SC21-03       | Ввести несуществующее название и нажать «Поиск»                    | SQL-запрос возвращает 0 строк                                                          | UI показывает «По вашему запросу ничего не найдено», маркеры отсутствуют                                               |
| 6  | SC21-03       | Изменить масштаб карты после результатов поиска                    | Логи: событие `map_zoom` с новым уровнем зума                                          | Карта корректно приближается/отдаляется; маркеры сохраняют своё положение                                              |
| 7  | SC21-04       | Выбрать маркер и нажать «Построить маршрут»                        | Логи: вызов `/route?shop_id=<id>`                                                      | На карте появляется линия маршрута (бэкенд обработал запрос и отправил результат во фронт)                             |
| 8  | SC21-04       | Построить маршрут до ближайшей аптеки                              | SQL: `SELECT * FROM pharmacies ORDER BY ST_Distance(user_location, location) LIMIT 1;` | Маршрут ведёт к ближайшей аптеке (бэкенд определил ближайшую запись в pharmacies, рассчитал дистанцию и отправил путь) |
| 10 | SC21-06       | Закрыть приложение и снова открыть после маршрута                  | Таблица `user_state.active_route` содержит данные маршрута                             | Приложение автоматически восстанавливает маршрут при старте                                                            |
| 11 | SC21-06       | Уровень батареи ниже 15%                                           | Логи: событие `battery_low`                                                            | Геолокация переключается на менее точный метод и не использует (Wi-Fi или сотовую связь) для более точной геопозиции   |
| 12 | SC21-06       | Отключить интернет и нажать «Поиск»                                | Логи: событие `network_error`                                                          | UI показывает «Нет соединения» и загружает данные из локального кэша                                                   |